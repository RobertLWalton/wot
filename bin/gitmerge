#!/bin/sh
#
# File:		gitmerge
# Author:	Bob Walton <walton@acm.org>
# Date:		Thu Apr 12 08:11:49 EDT 2012
#
# The author(s) have placed this program in the public
# domain; they make no warranty and accept no liability
# for this program.


case $1 in -doc*)
    echo "
gitmerge
    Merge files from the current repository's remote
    origin to the current repository.  Does an implicit
    fetch of the \`origin' branch of the current reposi-
    tory, and then merges this branch into the current
    repository.

    Use this if gitpull fails.  Use gitconflict first
    to see the nature of the failure.  Some files may
    have merge conflicts that have to be adjusted by
    editing and committing them after running gitmerge,
    in which case you may need to run gitpush after
    committing the files to finish resolving the
    conflicts.

    All files must be committed first.  If this is
    not the case, gitmerge complains and aborts."

    exit 1
    ;;
esac

stat=`git status | egrep "^#[ 	]+([a-z ]+:|Chang)"`
if test "$stat" != ""
then
    echo There are uncommitted files:
    echo "$stat"
    echo Commit before pull.
    echo Aborting.
    exit 1
fi

git fetch origin
git merge origin/master
